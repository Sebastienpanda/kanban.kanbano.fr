<div class="flex h-dvh overflow-hidden bg-base-200">
  <app-sidebar
    [workplaces]="workplaces()"
    [activeWorkplaceId]="activeWorkplaceId()"
    [collapsed]="sidebarCollapsed()"
    (workplaceSelected)="onWorkplaceSelected($event)"
    (sidebarToggled)="onSidebarToggled()"
  />

  <div class="flex-1 flex flex-col overflow-hidden">
    <header class="bg-base-300 border-b border-base-content/10 px-4 lg:px-6 py-3 lg:py-4 flex items-center justify-between shadow-lg backdrop-blur-xl">
      <div class="flex items-center gap-2 lg:gap-4 flex-1 min-w-0">
        <!-- Mobile menu button -->
        <button class="btn btn-ghost btn-sm btn-circle md:hidden" (click)="onSidebarToggled()">
          <lucide-icon [img]="MenuIcon" [size]="20"></lucide-icon>
        </button>

        <h1
          class="text-lg lg:text-2xl truncate">
          {{ activeWorkplace()?.name }}
        </h1>
        <div class="badge badge-primary badge-sm lg:badge-lg gap-1 lg:gap-2 shadow-lg hidden sm:flex">
          <span class="hidden lg:inline">{{ activeColumns().length }} colonnes</span>
          <span class="lg:hidden">{{ activeColumns().length }}</span>
        </div>
      </div>

      <div class="flex items-center gap-2 lg:gap-3">
        <button class="btn btn-primary btn-sm gap-2 shadow-lg hover:scale-105 transition-transform hidden sm:flex">
          <lucide-icon [img]="PlusIcon" [size]="16"></lucide-icon>
          <span class="hidden lg:inline">Nouvelle t√¢che</span>
        </button>
        <button class="btn btn-primary btn-sm btn-circle sm:hidden">
          <lucide-icon [img]="PlusIcon" [size]="16"></lucide-icon>
        </button>
        <button class="btn btn-ghost btn-sm btn-circle hidden sm:flex">
          <lucide-icon [img]="BellIcon" [size]="18"></lucide-icon>
        </button>
        <button class="btn btn-ghost btn-sm btn-circle" (click)="toggleTheme()">
          @if (isDarkMode()) {
            <lucide-icon [img]="SunIcon" [size]="18"></lucide-icon>
          } @else {
            <lucide-icon [img]="MoonIcon" [size]="18"></lucide-icon>
          }
        </button>
        <button class="btn btn-ghost btn-sm btn-circle">
          <lucide-icon [img]="SettingsIcon" [size]="18"></lucide-icon>
        </button>
      </div>
    </header>

    <main class="flex-1 overflow-hidden">
      @if (activeWorkplace()) {
        <app-kanban
          [columns]="activeColumns()"
          [onColumnsChange]="onColumnsChange.bind(this)"
        />
      }
    </main>
  </div>
</div>
